<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Project 07 — Private DB + Public Web Architecture</title>

  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../style.css?v=61"/>
</head>

<body>

<header class="site-header">
  <div class="container header-inner">
    <a class="brand-link" href="../index.html">
      <span class="brand-logo">ROHITH JP</span>
    </a>
    <nav class="nav">
      <a href="../index.html">Home</a>
      <a class="active" href="#">Project</a>
      <a href="../experience/experience.html">Experience</a>
    </nav>
  </div>
</header>

<main class="container">

  <!-- HERO -->
  <section class="project-hero">
    <div class="hero-title" style="font-size:34px;font-weight:700;">
      07 — Private Database + Public Web Server Deployment (AWS VPC Architecture)
    </div>
    <p class="subtitle">
      A fully secured two-tier AWS architecture with a public-facing NGINX + PHP web server and a private MySQL database,
      connected through strict VPC segmentation, security groups, and real-world enterprise best practices.
    </p>
  </section>

  <!-- WORKFLOW -->
  <section class="block">
    <h3>Workflow</h3>

    <div class="arch-diagram" style="margin-top:18px; overflow-x:auto;">
      <svg viewBox="0 0 1500 150" xmlns="http://www.w3.org/2000/svg" style="min-width:1250px;height:150px;">

        <!-- Browser -->
        <rect x="20" y="40" width="240" height="55" rx="10"
              fill="#05131a" stroke="#2ec4ff" stroke-width="1.8"/>
        <text x="140" y="72" text-anchor="middle" fill="#2ec4ff"
              font-family="IBM Plex Mono" font-size="12">Browser / Users</text>

        <!-- Public EC2 -->
        <rect x="300" y="40" width="300" height="55" rx="10"
              fill="#05131a" stroke="#7e3cff" stroke-width="1.8"/>
        <text x="450" y="72" text-anchor="middle" fill="#7e3cff"
              font-family="IBM Plex Mono" font-size="12">Public EC2 (NGINX + PHP)</text>

        <!-- Private EC2 (DB) -->
        <rect x="650" y="40" width="320" height="55" rx="10"
              fill="#05131a" stroke="#ff9900" stroke-width="1.8"/>
        <text x="810" y="72" text-anchor="middle" fill="#ff9900"
              font-family="IBM Plex Mono" font-size="12">Private EC2 (MySQL Database)</text>

        <!-- Arrows -->
        <line x1="260" y1="67" x2="300" y2="67" stroke="#2ec4ff" stroke-width="2.5"/>
        <line x1="600" y1="67" x2="650" y2="67" stroke="#7e3cff" stroke-width="2.5"/>

      </svg>
    </div>
  </section>

  <!-- PROJECT OBJECTIVE -->
  <section class="block">
    <h3>Project Objective</h3>
    <p>
      The goal was to build a secure and production-like AWS environment consisting of a public-facing
      web server and a completely private database server inside a VPC, exactly how enterprises design
      secure applications.
    </p>
    <ul class="exp-list">
      <li>Public EC2 hosting website (NGINX + PHP)</li>
      <li>Private EC2 hosting MySQL database</li>
      <li>1 Public subnet + 1 Private subnet</li>
      <li>No NAT gateway (cost saving)</li>
      <li>Database accessible only from public EC2 private IP</li>
    </ul>
  </section>

  <!-- ARCHITECTURE -->
  <section class="block">
    <h3>AWS Architecture</h3>

    <h4>VPC Configuration</h4>
    <ul class="exp-list">
      <li>VPC CIDR: 10.10.0.0/16</li>
      <li>Public Subnet: 10.10.1.0/24</li>
      <li>Private Subnet: 10.10.2.0/24</li>
      <li>IGW attached → for public EC2 access</li>
      <li>Private subnet: no NAT / no internet</li>
    </ul>

    <h4>Security Groups</h4>
    <ul class="exp-list">
      <li><strong>sg_web (Public EC2)</strong>: HTTP/HTTPS + SSH</li>
      <li><strong>sg_db (Private EC2)</strong>: MySQL 3306 allowed ONLY from sg_web</li>
    </ul>
  </section>

  <!-- EC2 SETUP -->
  <section class="block">
    <h3>EC2 Setup</h3>

    <h4>Public EC2 (Web Server)</h4>
    <ul class="exp-list">
      <li>Ubuntu 24.04</li>
      <li>Installed NGINX, PHP 8.3, PHP-FPM</li>
      <li>Cloned site to <code>/var/www/sms_site</code></li>
    </ul>

    <h4>Private EC2 (Database)</h4>
    <ul class="exp-list">
      <li>Installed MySQL server</li>
      <li><code>bind-address = 0.0.0.0</code> to allow VPC access</li>
      <li>Listening on port 3306 for internal VPC networks</li>
    </ul>
  </section>

  <!-- DB CONFIG -->
  <section class="block">
    <h3>Database Configuration</h3>
    <pre class="code-block">
CREATE USER 'sms_user'@'10.10.%' IDENTIFIED BY 'StrongSmsPassword!23';
GRANT ALL PRIVILEGES ON sms_db.* TO 'sms_user'@'10.10.%';
FLUSH PRIVILEGES;
    </pre>

    <p>Database imported via:</p>
    <pre class="code-block">
mysql -h 10.10.2.137 -u sms_user -p sms_db < studentmsdb.sql
    </pre>
  </section>

  <!-- WEB SERVER CONFIG -->
  <section class="block">
    <h3>Web Server Configuration</h3>
    <p>NGINX site configuration:</p>

    <pre class="code-block">
server {
  listen 80;
  root /var/www/sms_site;
  index index.php index.html;

  location / {
    try_files $uri $uri/ /index.php?$query_string;
  }

  location ~ \.php$ {
    include snippets/fastcgi-php.conf;
    fastcgi_pass unix:/run/php/php8.3-fpm.sock;
  }
}
    </pre>
  </section>

  <!-- MAJOR ISSUE -->
  <section class="block">
    <h3>Major Issue — HTTP 500 (Database Connection Failure)</h3>

    <p><strong>Root Cause:</strong> Only one dbconnection.php file was updated.  
      The site had 3 separate config folders (user/admin/includes).</p>

    <p><strong>Fix:</strong> Updated both user + admin config files to:</p>

    <pre class="code-block">
define('DB_HOST','10.10.2.137');
define('DB_USER','sms_user');
define('DB_PASS','StrongSmsPassword!23');
define('DB_NAME','sms_db');
    </pre>

    <p><strong>Result:</strong></p>
    <ul class="exp-list">
      <li>Login works</li>
      <li>Admin dashboard works</li>
      <li>User pages work</li>
    </ul>
  </section>

  <!-- CHALLENGES -->
  <section class="block">
    <h3>Challenges & Fixes</h3>
    <ul class="exp-list">
      <li><strong>SSH to private EC2 failed</strong> → fixed SG inbound rules</li>
      <li><strong>MySQL rejected connections</strong> → bind-address updated</li>
      <li><strong>Host not allowed</strong> → user created with <code>10.10.%</code></li>
      <li><strong>Login broken</strong> → updated all config files</li>
      <li><strong>NAT confusion</strong> → learned private DB doesn’t need internet</li>
      <li><strong>Public IP changed</strong> → only SSH commands updated</li>
    </ul>
  </section>

  <!-- VALIDATION -->
  <section class="block">
    <h3>Final Architecture Validation</h3>
    <ul class="exp-list">
      <li>Browser → Public EC2 (NGINX)</li>
      <li>Public EC2 → Private EC2 MySQL via private IP</li>
      <li>Database accessible only through sg_web SG</li>
      <li>Private EC2 completely isolated from the internet</li>
    </ul>
  </section>

  <!-- RE-RUN CHECKLIST -->
  <section class="block">
    <h3>Re-run Checklist</h3>
    <ul class="exp-list">
      <li>Public EC2 has public IP + SG allows HTTP</li>
      <li>Private EC2 has no public IP</li>
      <li>MySQL bind-address = 0.0.0.0</li>
      <li>MySQL user host: 10.10.%</li>
      <li>All PHP files use correct DB credentials</li>
      <li>Connectivity test: <code>nc -zv &lt;private-db-ip&gt; 3306</code></li>
    </ul>
  </section>

  <!-- OUTCOME -->
  <section class="block">
    <h3>Outcome</h3>
    <p>
      You successfully built a real-world two-tier infrastructure with strict security boundaries,
      database isolation, secure NGINX/PHP deployment, and full VPC control. This mirrors actual
      enterprise production design.
    </p>
  </section>

  <!-- NAVIGATION BUTTONS -->
  <section class="project-nav" style="margin-top:35px; display:flex; gap:16px;">
    <a class="btn btn-outline" href="project6.html">← Previous</a>
    <a class="btn btn-primary" href="../index.html">Finish →</a>
  </section>

</main>

<footer class="site-footer">
  <div class="container"><small>© 2025 Rohith Jothilakshmi Periyasamy</small></div>
</footer>

</body>
</html>
